<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Denoising Functional Maps</title>

    <meta name="description" content="Diffusion Models for Shape Correspondence"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <meta property="og:image" content="https://moritzkappel.github.io/projects/dnpc/assets/dnpc_pipeline_og.jpg">
    <meta property="og:image:type" content="image/jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="Denoising Functional Maps: Diffusion Models for Shape Correspondence"/>
    <meta property="og:description" content="A novel approach for predicting shape correspondences in the form of functional maps using denoising diffusion models."/>

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="https://moritzkappel.github.io/projects/dnpc/"/>
    <meta name="twitter:title" content="Denoising Functional Maps: Diffusion Models for Shape Correspondence"/>
    <meta name="twitter:description" content="A novel approach for predicting shape correspondences in the form of functional maps using denoising diffusion models."/>
    <meta name="twitter:image" content="https://moritzkappel.github.io/projects/dnpc/assets/dnpc_pipeline_tw.jpg"/> -->

    <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">
    <link rel="icon" href="assets/favicon/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="assets/favicon/site.webmanifest">

    <link rel="stylesheet" href="css/app.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">

    <script src="js/jquery-1.12.4.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <script defer src="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/index.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/styles.css"/>  

    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
</head>

<body>
<div class="container" id="main">

    <div class="row">
        <h2 class="col-md-12 text-center">
            <b>Denoising Functional Maps</b>: Diffusion Models for Shape Correspondence<br>
            <small>
                Accepted at CVPR 2025
            </small>
        </h2>
    </div>
    <div class="row">
        <div class="col-md-12 text-center">
            <!-- List should be aligned by top -->
            <ul class="list-inline text-center" style="display: flex; justify-content: center;">
                <li>
                    <a style="text-decoration:none" href="https://alekseizhuravlev.github.io/">Aleksei Zhuravlev</a>
                    <br>University of Bonn
                </li>
                <li>
                    <a style="text-decoration:none" href="https://zorah.github.io/">Zorah Lähner</a>
                    <br>University of Bonn
                    <br>Lamarr Institute
                </li>
                <li>
                    <a style="text-decoration:none" href="https://people.mpi-inf.mpg.de/~golyanik/">Vladislav Golyanik</a>
                    <br>MPI for Informatics
                </li>
            </ul>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6 col-md-offset-3 text-center">
            <!-- <ul class="nav nav-pills nav-justified nav-fill"> -->
            <ul class="nav nav-pills nav-fill text-center" style="display: flex; justify-content: center;">
                <li class="nav-item">
                    <a class="nav-link" href="https://arxiv.org/pdf/2503.01845">
                        <img src="assets/Paper_preview.png" height="60px" style="border: 1px solid black;">
                        <h4><strong>Paper</strong></h4>
                    </a>
                </li>
                <!-- <li class="nav-item">
                    <a class="nav-link" href="https://www.youtube.com/watch?v=NSpptS38uL0">
                        <img src="assets/youtube_icon.png" height="60px">
                        <h4><strong>Video</strong></h4>
                    </a>
                </li> -->
                <li class="nav-item">
                    <a class="nav-link" href="javascript:void(0);">
                        <img src="assets/github.png" height="60px">
                        <h4><strong>Code (soon)</strong></h4>
                    </a>
                </li>
                <li>
                    <a href="javascript:void(0);">
                    <image src="assets/database_icon.png" height="60px">
                        <h4><strong>Data (soon)</strong></h4>
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <div class="row" style="padding-top: 10pt;">
        <div class="col-md-10 col-md-offset-1 text-center">
            <!-- <hr> -->
            <img src="assets/Teaser_figure_upd.jpg" style="width:100%; padding-bottom:20px;">
            <p>
                We propose <b>DenoisFM</b>, a novel framework for predicting shape correspondences in the form of <b>functional maps</b> using <b>Denoising Diffusion Models</b>.<br>
                <!-- (Left:) Challenging examples our method can handle, with color-coded correspondences.<br>
                 (Right:) By sequentially denoising samples of random noise, the diffusion model can predict the correct functional map between a pair of shapes. -->
            </p>
    </div>

    <div class="row">
        <div class="col-md-10 col-md-offset-1">
            <hr>
            <h3><b>Abstract</b></h3>
            <hr>
            <p class="text-justify">
                Estimating correspondences between pairs of deformable shapes remains a challenging problem. 
                Despite substantial progress, existing methods lack broad generalization capabilities and require domain-specific training data.
                To address these limitations, we propose a fundamentally new approach to shape correspondence based on denoising diffusion models. 
                In our method, a diffusion model learns to directly predict the functional map, i.e. a low-dimensional representation for a point-wise map between shapes.
                We use a large dataset of synthetic human meshes for training and employ two steps to reduce the number of functional maps that need to be learned.
                First, the maps refer to a template rather than to shape pairs.
                Second, the functional map is defined in a basis of eigenvectors of the Laplacian, which is not unique due to sign ambiguity.
                Therefore, we introduce an unsupervised approach to select a specific basis by correcting the signs of eigenvectors based on surface features.
                Our approach achieves competitive performance on standard human datasets, meshes with anisotropic connectivity, non-isometric humanoid shapes, as well as animals compared to existing descriptor-based and large-scale shape deformation methods. 
            </p>
        </div>

    </div>

    <div class="row">
        <div class="col-md-10 col-md-offset-1">
            <hr>
            <h3><b>Method</b></h3>
            <hr>
            <img src="assets/Method_figure_double_upd.jpg" style="width:100%">
            <p class="text-justify">
                <br>
                <b>(a) Functional map prediction using a diffusion model</b>. 
                For each unique shape in the dataset, we obtain surface features using a feature extractor, as well as a sign-corrected eigenbasis.
                Both are used for conditional prediction of the template-wise functional map using a diffusion model. 
                The pairwise functional maps are obtained through the map composition property, upsampled using ZoomOut, and converted to pointwise maps.
                <br>
            </p>
        </div>
    </div>

    <div class="row" style="padding-top: 20px;">
        <div class="col-md-10 col-md-offset-1">
            <img src="assets/Method_sign_correction_upd.jpg" style="width:100%">
            <p class="text-justify">
                <br>
                <b>(b) Learned sign correction</b>.
                The eigenvectors returned by a numerical eigensolver have random signs.
                To select a specific sign, we project the eigenvectors onto the learned correction vector obtained with a feature extractor, and make the projection positive. 
                The sign correction network is trained in an unsupervised manner: learning to correct eigenvectors that have random signs. 
                <br>
            </p>
        </div>
    </div>


    <div class="row">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <hr>
            <h3><b>Training Data</b></h3>
            <hr>
            <p>Section in progress...</p>
        </div>
    </div>


    <div class="row">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <hr>
            <h3><b>Results</b>: Shape Correspondence</h3>
            <hr>
            <h3>Humans</h3>
            <hr>
        </div>
    </div>

    <div class="row" style="margin-bottom: 20px;">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <img src="assets/Humans_examples.jpg" class="img-responsive center-block" >
        </div>
    </div>

    <div class="row"  style="margin-bottom: 20px;">
        <div class="col-10 col-md-4 col-md-offset-4 text-center vertical-center">
            <img src="assets/Humans_results.png" class="img-responsive center-block">
        </div>
    </div>

    <div class="row">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <hr>
            <h3>Humanoids</h3>
            <hr>
        </div>
    </div>

    <div class="row" style="margin-bottom: 10px;">
        <div class="col-10 col-md-8 col-md-offset-2 text-center" >
            <img src="assets/Website_humanoids_examples.jpg" class="img-responsive center-block" >
        </div>
    </div>

    <div class="row" style="margin-bottom: 20px;">
        <div class="col-10 col-md-4 col-md-offset-4 text-center vertical-center">
            <img src="assets/Website_humanoids_results.png" class="img-responsive center-block">
        </div>
    </div>

    <div class="row">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <hr>
            <h3>Animals</h3>
            <hr>
        </div>
    </div>

    <div class="row" style="margin-bottom: 10px;">
        <div class="col-10 col-md-8 col-md-offset-2 text-center" >
            <img src="assets/Website_animals_examples.jpg" class="img-responsive center-block" >
        </div>
    </div>

    <div class="row" style="margin-bottom: 30px;">
        <div class="col-10 col-md-4 col-md-offset-4 text-center vertical-center">
            <img src="assets/Website_animals_results.png" class="img-responsive center-block">
        </div>
    </div>

    <div class="row" style="margin-bottom: 0px;">
        <div class="col-10 col-md-10 col-md-offset-1">
            <p class="text-justify">
                We test our approach on the dataset containing <b>7 types of animals</b>.
                For training, we use the fitted parameters of the SMAL parametric model and randomly vary the pose of 32 training animals, generating a total of 64,000 meshes.
                As a result, we achieve <b>comparable performance</b> to the baselines.
                Therefore, given enough training data, we believe our method can be applied to <b>any shape class</b>.
            </p>
        </div>
    </div>



    <div class="row">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <hr>
            <h3><b>Results</b>: Sign Correction of Laplacian Eigenvectors</h3>
        </div>
    </div>


    <div class="row">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <hr>
            <h3>Accuracy</h3>
            <hr>
        </div>
    </div>

    <div class="row" style="margin-bottom: 30px;">
        <div class="col-10 col-md-4 col-md-offset-4 text-center vertical-center">
            <img src="assets/Website_sign_corr_accuracy.png" class="img-responsive center-block">
        </div>
    </div>

    <div class="row" style="margin-bottom: 0px;">
        <div class="col-10 col-md-10 col-md-offset-1">
            <p class="text-justify">Given a set of eigenvectors with <b>random signs</b>,
                our trained sign correction networks the <b>same basis combination</b> in \({>}95\%\) of cases on standard human datasets.
            </p>
        </div>
    </div>



    <div class="row">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <hr>
            <h3>Distribution of Functional Maps</h3>
            <hr>
        </div>
    </div>

    <div class="row" style="margin-bottom: 10px;">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <img src="assets/PCA_fmaps.jpg" class="img-responsive center-block" style="margin-bottom: 20px;">
            <p class="text-justify">
                For the FAUST dataset, we plot the first two PCA components for:</p>
            <!-- Add a list with a), b), c) -->
            <ol type="a" class="text-left">
                <li>functional maps between each shape and the
                    template <b>before</b> sign correction</li>
                <li>functional maps <b>after</b> sign correction</li>
                <li><b>conditioning</b> matrix after sign correction</li>
            </ol>
            <p class="text-justify">
                Each entry is
                colored according to its shape class. Note the <b>clusters</b> that form for the functional maps and conditioning matrices after sign correction.
            </p>
        </div>
    </div>


    <div class="row">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <hr>
            <h3>Learned Correction Vectors</h3>
            <hr>
        </div>
    </div>

    <div class="row" style="margin-bottom: 10px;">
        <div class="col-10 col-md-8 col-md-offset-2 text-center" >
            <img src="assets/Website_correction_vectors.jpg" class="img-responsive center-block" style="margin-bottom: 10px;">
            <br>
        </div>
    </div>

    <div class="row" style="margin-bottom: 10px;">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <p class="text-justify">
                <!-- The learned correction vectors are used to resolve the <b>sign ambiguity</b> of eigenvectors of Laplace-Beltrami operator.
                Since \(+\phi_i\) and \(-\phi_i\) are both valid eigenvectors, we project them onto the <b>learned correction vector</b> \(\varsigma_i\) and select the one with the <b>positive projection</b>. -->
                We visualize several of the <b>learned correction vectors</b> \(\varsigma_i\), along with the corresponding eigenvectors \(\phi_i\).
                The low-order correction vectors resemble the <b>eigenvectors themselves</b>, while the high-order ones are mostly concentrated in the <b>arm</b> and <b>hand</b> regions.
            </p>
        </div>
    </div>



    <div class="row">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <hr>
            <h3>Limitations</h3>
            <hr>
        </div>
    </div>

    <div class="row" style="margin-bottom: 10px;">
        <div class="col-10 col-md-10 col-md-offset-1 text-center" >
            <img src="assets/Additional_Limitations.jpg" class="img-responsive center-block" >
            <!-- Add a bullet list of limitations -->
             <br>
            <p class="text-justify">
                The <b>main limitations</b> of our method include:
            </p>
             <ul class="text-left">
                <li>Shapes with <b>significant differences</b> from the synthetic human data we used for training (an alien with large claws or a mouse).</li>
                <li><b>Partial shapes</b> (with missing body parts).</li>
                <li>Shapes with <b>challenging topology</b> that are not handled well by the functional map framework (holes, self-intersections).</li>
            </ul>
        </div>
    </div>


    <!-- <div class="row">
        <div class="col-md-10 col-md-offset-1 text-center">
            <h4>More examples coming soon! </h4>
            <p>Animals, Distribution of FMaps, correction vectors, comments</p>
        </div>
    </div> -->



    <div class="row">
        <div class="col-md-10 col-md-offset-1">
            <h3>BibTeX</h3>
            <hr>
<pre id="bibtex">
@misc{zhuravlev2025denoising,
    title={Denoising Functional Maps: Diffusion Models for Shape Correspondence}, 
    author={Aleksei Zhuravlev and Zorah Lähner and Vladislav Golyanik},
    year={2025},
    eprint={2503.01845},
    archivePrefix={arXiv},
    primaryClass={cs.CV},
    url={https://arxiv.org/abs/2503.01845}, 
}
</pre>
        </div>
    </div>
    

    <!-- <div class="row">
        <div class="col-md-10 col-md-offset-1">
            <h3>BibTeX</h3>
            <hr>
<pre>
soon @inproceedings{kappel2024d-npc,
  title = {D-{NPC}: Dynamic Neural Point Clouds for Non-Rigid View Synthesis from Monocular Video},
  author = {Kappel, Moritz and Hahlbohm, Florian and Scholz, Timon and Castillo, Susana  and Theobalt, Christian and Eisemann, Martin and Golyanik, Vladislav and Magnor, Marcus},
  booktitle = {Proc. Eurographics},
  editor = {A. Bousseau and A. Dai},
  volume = {44},
  number = {2},
  note = {To appear},
  year = {2025}
}
</pre>
        </div>
    </div>
-->

    <div class="row">
        <div class="col-md-10 col-md-offset-1">
            <br>
            <br>
            <p class="text-center" style="font-size: 8pt;">
                Template sources: <a href="https://moritzkappel.github.io/projects/dnpc/", style="font-size: 8pt;">D-NPC</a>, <a href="http://mgharbi.com/" , style="font-size: 8pt;">Michaël Gharbi</a>, <a href="https://dorverbin.github.io/refnerf", style="font-size: 8pt;">Ref-NeRF</a>.
            </p>
            <br>
            <br>
        </div>
    </div>
</div>

</body>
</html>
